<div
    data-lvg-board-card-menu
    data-ng-class="::{'lavagna-is-watching': !$ctrl.listView && $ctrl.isSelfWatching, 'lavagna-board-panel' : $ctrl.boardView }">
    <!-- <lvg-card-fragment-v2-head></lvg-card-fragment-v2-head> -->
    <div>
        <div>
            <div lvg-if-instant="::($ctrl.boardView && !$ctrl.readOnly)">
                <div>
                    <input lvg-if-instant="::($ctrl.hideSelect !== 'true')" type="checkbox"  lvg-has-permission="MANAGE_LABEL_VALUE" class="lavagna-board-card-checkbox" 
                        lvg-card-fragment-checkbox></input>
                    <lvg-card-fragment-link
                        dynamic-link="true"
                        target-state="board.card"
                        project-name="{{::$ctrl.projectShortName}}" 
                        board-short-name="{{::$ctrl.boardShortName}}"
                        sequence-number="{{::$ctrl.card.sequence}}"></lvg-card-fragment-link>
                </div>
                <div>
                    <div lvg-has-at-least-one-permission="MOVE_CARD,MANAGE_LABEL_VALUE">
                        <div class="lavagna-card-caret-container lvg-not-sortable-card" ng-click="openCardMenu($ctrl.card, $ctrl.projectMetadataRef())"><span class="fa fa-chevron-down"></span></div>
                    </div>
                </div>
            </div>
            <div lvg-if-instant="::($ctrl.boardView && $ctrl.readOnly)">
                <div><span class="fake-link" ng-bind="::$ctrl.shortCardName"></span></div>
            </div>
            <div lvg-if-instant="::($ctrl.listView)">
                <div>
                    <lvg-card-fragment-link
                        target-state="board.card"
                        project-name="{{::$ctrl.projectShortName}}" 
                        board-short-name="{{::$ctrl.boardShortName}}"
                        sequence-number="{{::$ctrl.card.sequence}}"></lvg-card-fragment-link>
                </div>
                <div class="card-home-date" ng-bind="::($ctrl.card.lastUpdateTime|dateIncremental)"></div>
            </div>
            <div lvg-if-instant="::($ctrl.searchView)">
                <div>
                    <input type="checkbox" lvg-has-permission="MANAGE_LABEL_VALUE" data-with-project="{{::$ctrl.card.projectShortName}}"
                        lvg-card-fragment-checkbox>
                    <lvg-card-fragment-link
                        dynamic-link="true"
                        target-state="{{::($ctrl.searchType == 'globalSearch' ? 'globalSearch.card' : 'projectSearch.card')}}"
                        project-name="{{::$ctrl.projectShortName}}" 
                        board-short-name="{{::$ctrl.boardShortName}}"
                        sequence-number="{{::$ctrl.card.sequence}}"></lvg-card-fragment-link>
                </div>
                <div class="card-home-date" ng-bind="::($ctrl.card.lastUpdateTime|dateIncremental)"></div>
            </div>
            <span ng-bind="::$ctrl.card.name"></span>
        </div> 
    </div>
    <div>
        <lvg-card-fragment-v2-data-info></lvg-card-fragment-v2-data-info>
        
        <div class="card-labels" lvg-if-instant="::$ctrl.hasUserCreatedLabels">
            <ul class="labels">
                <li class="lavagna-label lavagna-label-no-controls" 
                    ng-style="::($ctrl.projectMetadata.labels[value.labelId].color|labelBackground)"
                    ng-class="::($ctrl.projectMetadata.labels[value.labelId].color|labelBackgroundClass)" 
                    lvg-card-fragment-label-repeat="$ctrl.userCreatedLabels" project-metadata-ref="$ctrl.projectMetadata"><lvg-label-v2 value-ref="value" project-metadata-ref="projectMetadata"></lvg-label-val-v2></li>
            </ul>
        </div>
    </div>
</div>